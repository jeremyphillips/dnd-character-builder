import type { ReactNode } from 'react'
import Typography from '@mui/material/Typography'
import { HorizontalCompactCard, type CardBadgeItem } from '@/ui/cards'

interface CampaignHorizontalCardProps {
  campaignId: string
  name: string
  description?: string
  imageUrl?: string
  /** DM / admin display name */
  dmName?: string
  edition?: string
  setting?: string
  /** Character's in-campaign status ('active' | 'inactive' | 'deceased') */
  characterStatus?: string
  /** Custom actions rendered in the card's action area (replaces default "View details") */
  actions?: ReactNode
}

const STATUS_BADGE_MAP: Record<string, CardBadgeItem> = {
  inactive: { type: 'status', value: 'Inactive' },
  deceased: { type: 'status', value: 'Deceased' },
}

const CampaignHorizontalCard = ({
  campaignId,
  name,
  description,
  imageUrl,
  dmName,
  edition,
  setting,
  characterStatus,
  actions: customActions,
}: CampaignHorizontalCardProps) => {
  const subheadline = [edition, setting].filter(Boolean).join(' Â· ')

  const badges: CardBadgeItem[] = []
  if (dmName) badges.push({ type: 'role', value: `DM: ${dmName}` })
  if (characterStatus && STATUS_BADGE_MAP[characterStatus]) {
    badges.push(STATUS_BADGE_MAP[characterStatus])
  }

  return (
    <HorizontalCompactCard
      image={imageUrl}
      headline={name}
      subheadline={subheadline || undefined}
      description={description}
      badges={badges}
      link={`/campaigns/${campaignId}`}
      actions={
        customActions ?? (
          <Typography variant="body2" color="primary" sx={{ fontSize: '0.8125rem' }}>
            View details
          </Typography>
        )
      }
    />
  )
}

export default CampaignHorizontalCard
